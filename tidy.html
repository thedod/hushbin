<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 25 March 2009), see www.w3.org">
  <!-- Security note: The string "src" should only appear inside this comment :) -->
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>HushBin - Tweetable secrets</title>
  <style type="text/css">
/*<![CDATA[*/
  /* Based on http://oocss.org */
  body{font-family:"Myriad Pro","Segoe UI",Helvetica, Arial, sans-serif}
  body{_text-align:center}/* IE5.5 */
  .main{display:table-cell;*display:block;width:auto}
  .leftCol{float:left;width:250px;_margin-right:-3px}
  .rightCol{float:right;width:300px;_margin-left:-3px}
  .body,.main{*zoom:1}
  .body:after,.main:after{clear:both;display:block;visibility:hidden;overflow:hidden;height:0 !important;line-height:0;font-size:xx-large;content:" x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x "}
  .page{margin:0 auto;width:950px;_text-align:left} /* wraps other template elems to set width */ /* text-align IE5.5 */
  @media screen and (max-width: 319px){.unit{float: none !important; width: auto !important}}
  .line:after,.lastUnit:after{clear:both;display:block;visibility:hidden;overflow:hidden;height:0 !important;line-height:0;font-size:xx-large;content:" x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x "}
  .line{*zoom:1}
  .unit{float:left}
  .size1of1{float:none}
  .lastUnit{display:table-cell;float:none;width:auto;*display:block;*zoom:1;_position:relative;_left:-3px;_margin-right:-3px}
  /* My overrides */
  .page{width:auto;font-size:16px}
  .leftCol,.rightCol{width:300px}
  .unit{margin:2px;padding: 4px}
  /* My styles */
  a{text-decoration:none;color:#090}
  a:hover{text-decoration:underline}
  p{padding:0;margin:0 0 4px 0}
  .head{font-weight:bold;text-align:center;font-size:23px;padding-bottom:4px}
  .legend{text-shadow:#777 1px 1px 2px}
  .online{border:outset #ccc 2px;font-size:12px;background-color:#fff}
  .crypt{background-color:#ddd}
  .secret{background-color:#bbb}
  .secretTxt{background-color:#000;color:#0f0;padding:8px;width:95%;font-size:10pt;font-weight:bold}
  .head,.secretTxt{font-family:"Courier New",monospace}
  .online,.crypt,.secret,.secretTxt,.maxWidth{-moz-border-radius:5px;-webkit-border-radius:5px}
  .formLabel{font-weight:bold;font-size:80%;text-shadow:white 1px 1px 0.5px}
  .maxWidth {width:99%}
  .noScrollBar{overflow-y:hidden}
  .pbResult{width:99%;height:50px;border:none}
  .decButton{width:100%;text-align:right;position:relative;left:16px;top:4px}
  .encButton{position:relative;left:-14px;top:4px}
  .pbButton{position:relative;top:-16px}
  /*]]>*/
  </style>
  <script type="text/javascript">
//<![CDATA[
  DEMOCIPHER='VVWx4eRIwZmo1/nO301CH/qkndNWmzaXkhfQXKSpnb5wpcL6zgmftvdq4XahyxRy0O+Tq79OcuGLQqpjsfQrdafhp9zoI5DdleK81Nd/GTAdg7HoUHTx5OZFhfiipt8/W9K1U284Y9j2C1mghSrKnEpoYfBswJkdTQYNwzz1GBoGpqyF2SiURuTPPmbCT+XQzFCqxfABtNWteUnT0RlYLw1qKdAmVJGZRDix1mOtT7aUTvILnS/BOnUXWfeTSfdV515dyE24SYoQMEaj9rwzfyDtq3QWIQWkKY/xibLgx9PthhGBcLWiP69eKQABMJ5KGHTGskug0jZRp+RU4hShq2mRN0z9+UbjinXLERUBMesEzA4pJ6YJs0wp/Zwh5B/AR3l+cYsASkTTY9vJDp8F3w7YYgXgj5uYVmLZ3/a+UPBus2ZOEJPgwKrSA0tqW4dON44ERfbgdGiBMkyoqBbgoPgK73nONa';
  function str2bin(s){
  // utf-16=>utf-8=>bin-array
  var result=new Array();
  var c;var i;var j;
  for (i=0,j=0;i<s.length;i++){
  c=s.charCodeAt(i);
  if (c<128){
  result[j++]=c} else if (c<2048){ // 2 byte utf-8
  result[j++]=(c>>6)|192;
  result[j++]=(c&63)|128} else { // 3 bytes
  result[j++]=(c>>12)|224;
  result[j++]=((c>>6)&63)|128;
  result[j++]=(c&63)|128}}
  return result}
  function bin2str(bin){
  // reverse of str2bin
  var result='';var i=0;
  while(i<bin.length){
  if (bin[i]<128){
  result+=String.fromCharCode(bin[i]);
  i++} else if ((bin[i]>191) && (bin[i]<224)){
  result+=String.fromCharCode(((bin[i]&31)<<6)|(bin[i+1]&63));
  i+=2} else {
  result+=String.fromCharCode(
  ((bin[i]&15)<<12)|((bin[i+1]&63)<<6)|(bin[i+2]&63));
  i+=3}}
  return result}
  base64lookup="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=";
  function base64Encode(bin){
  var len=bin.length;
  var res='';
  var shift=0;
  var leftover=0;
  for (var i=0;i<len;i++){
  res+=base64lookup.charAt((bin[i]<<shift|leftover) & 63);
  leftover=bin[i]>>(6-shift);
  shift+=2;
  if (shift==6||i==len-1){res+=base64lookup.charAt(leftover);shift=0;leftover=0};
  if (i && !(i%60))res+='\r\n'}
  return res}
  function base64Decode(s){
  var len=s.length;
  var res=new Array();
  var shift=0;
  var leftover=0;
  var lookup;
  var index=0;
  for (var i=0;i<s.length;i++){
  lookup=base64lookup.indexOf(s.charAt(i));
  if (lookup>=0){ // skip whitespace
  if (shift){
  res[index++]=(lookup<<(8-shift) & 255)|leftover}
  leftover=lookup>>shift;
  shift=(shift+2)%8}}
  return res}
  //== crypto ==
  function make_iv(){
  // Generate a random 10 byte iv
  var result=new Array();
  for (var i=0;i<10;i++)
  result[i]=256 * Math.random();
  return result}
  function _cs2(key, bin){
  // RC4 part of cs2 (key should contain iv)
  var i, j, temp;
  s=new Array();
  for (i=0;i<256;i++)
  s[i]=i;j=0;
  for (var k=0;k<20;k++){
  for (i=0;i<256;i++){
  j=(key[i % key.length]+s[i]+j) & 255;
  temp=s[i];s[i]=s[j];s[j]=temp}}
  var result=new Array(bin.length);
  j=0;i=0;
  for (var index=0;index<bin.length;index++){
  i=(i+1) & 255
  j=(s[i]+j) & 255;
  temp=s[i];s[i]=s[j];s[j]=temp;
  result[index]=bin[index]^s[(s[i]+s[j])&255]}
  return result}
  //== "exportable" crypto functions ==
  // CipherSaber 2 algorithm with N=20
  // See http://bit.ly/ciphersaberarchive
  function cs2encrypt(key,text){
  var iv=make_iv();
  var binkey=str2bin(key).concat(iv);
  return base64Encode(iv.concat(_cs2(binkey,str2bin(text))))}
  function cs2decrypt(key,cipher){
  var bin=base64Decode(cipher);
  var binkey=str2bin(key).concat(bin.slice(0,10));
  bin=bin.slice(10);
  return bin2str(_cs2(binkey,bin))}
  // == gui ==
  function $$(i){return document.getElementById(i)} // mock jquery :)
  function show_msg(m){
  alert(m); /* temporary (yeah. Right) */}
  // crypto gui actions
  function do_encrypt(){
  var key=$$('out-key').value;
  var text=$$('plaintext').value;
  if (text.length && key.length && key==$$('out-key-verify').value){
  $$('out-cipher').value=cs2encrypt(key,text)} else {
  show_msg("No secret text, empty pass phrase,\nor pass phrases don't match.")}}
  function do_decrypt(){
  var key=$$('in-key').value;
  if (key.length){
  $$('plaintext').value=cs2decrypt(key,$$('in-cipher').value)} else {
  show_msg("Empty pass phrase.")}}
  function demo(){
  $$('in-cipher').value=DEMOCIPHER;
  $$('in-key').value='';
  $$('in-key').focus();
  show_msg('Pass phare is "lamefraze".\nEvidently it\'s not a strong one ;)')}
  // avoid posting empty pastebins
  function validate_pastebin_form(){
  if ($$('out-cipher').value.replace(/^\s+|\s+$/g,"").length){
  return true}
  show_msg("Encrypt something first.");
  return false}
  // kb handlers
  function nop(){return false};
  function if_enter(e,f){var k=0;if (window.event)k=window.event.keyCode;else if (e)k=e.which;
  if (k==13){return f() && false};return true}
  // onload
  function init(){
  $$('pb_form').target='pb_result';linx=document.getElementsByTagName('a');
  for (i in linx){l=linx[i];if (l.href && !l.href.match('#'))l.target='_blank'}}
  //]]>
  </script>
</head>

<body onload="init()">
  <div class="page">
    <div class="head">
      HushBin — Tweetable secrets
    </div>

    <div class="body">
      <div class="leftCol">
        <div class="line">
          <div class="unit crypt lastUnit">
            <div class="legend">
              Read a secret
            </div>

            <div class="line">
              <div class="unit online lastUnit">
                <strong><a href=
                "http://wiki.github.com/thedod/hushbin/">Instructions
                are here</a></strong>. Here's a quick demo:<br>
                <input type="button" onclick="demo()" value=
                "Paste demo encrypted secret ↴">
              </div>
            </div>

            <div class="line">
              <div class="unit lastUnit">
                <div class="formLabel">
                  ▼ Encrypted input:
                </div>

                <div>
                  <textarea tabindex="1" id="in-cipher" cols="5"
                  rows="3" class="maxWidth noScrollBar" onclick=
                  "this.select()">
</textarea>
                </div>

                <div class="formLabel">
                  Pass phrase:
                </div>

                <div>
                  <input tabindex="2" class="maxWidth" type=
                  "password" id="in-key" onkeypress=
                  "if_enter(event,do_decrypt)">
                </div>

                <div class="decButton">
                  <input tabindex="3" onclick="do_decrypt()" type=
                  "button" value="↳ Decrypt ▶">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="rightCol">
        <div class="line">
          <div class="unit size1of1 lastUnit">
            <strong>Warning:</strong> Before encrypting any
            <em>real</em> secrets, read the <a href=
            "http://wiki.github.com/thedod/hushbin/">Instructions</a>.
          </div>
        </div>

        <div class="line">
          <div class="unit size1of1 lastUnit crypt">
            <div class="legend">
              Write a secret
            </div>

            <div class="line">
              <div class="unit size1of1 lastUnit">
                <div class="formLabel">
                  <a href=
                  "http://wiki.github.com/thedod/hushbin/strong-pass-phrases">
                  Strong</a> pass phrase:
                </div>

                <div>
                  <input tabindex="5" class="maxWidth" type=
                  "password" id="out-key">
                </div>

                <div class="formLabel">
                  Verify pass phrase:
                </div>

                <div>
                  <input tabindex="6" class="maxWidth" type=
                  "password" id="out-key-verify" onkeypress=
                  "return if_enter(event,do_encrypt)">
                </div>

                <div class="encButton">
                  <input tabindex="7" onclick="do_encrypt()" type=
                  "button" value="▶ Encrypt ↴">
                </div>
              </div>
            </div>

            <div class="line">
              <div class="unit size1of1 lastUnit">
                <form id="pb_form" method="post" action=
                "http://pastebin.com/api_public.php" onkeypress=
                "return if_enter(event,nop)" onsubmit=
                "return validate_pastebin_form()" name="pb_form">
                  <div class="formLabel">
                    ▼ Encrypted output:
                  </div>

                  <div>
                    <textarea tabindex="8" name="paste_code" id=
                    "out-cipher" cols="5" rows="3" class=
                    "maxWidth noScrollBar" readonly="readonly"
                    onclick="this.select()">
</textarea>
                  </div>

                  <div class="line">
                    <div class="unit size1of1 online lastUnit">
                      <input type="hidden" name="paste_name" value=
                      "bit.ly/hushbin"> <input type="hidden" name=
                      "paste_private" value="1">

                      <div class="pbButton">
                        <input tabindex="9" id="pastebin_button"
                        type="submit" value=
                        "▼ Create a tweetable pastebin">
                      </div><iframe class="pbResult" id="pb_result"
                      name="pb_result"></iframe>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="main">
        <div class="line">
          <div class="unit size1of1 secret lastUnit">
            <div class="formLabel">
              Secret:
            </div>
            <textarea tabindex="4" cols="23" rows="21" id=
            "plaintext" class="secretTxt">
</textarea>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
